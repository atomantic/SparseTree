# v0.8.3

## Added
- 12 shared server utilities (`paths`, `downloadImage`, `parseYear`, `lifespan`, `validation`, `asyncHandler`, `sseHelpers`, `operationTracker`, `resolveCanonical`, `browserConnect`, `applyOverrides`, `batchFetchPersons`)
- `useBrowserConnection` and `useSSE` client hooks for deduplication
- Path traversal defense-in-depth across all file-serving endpoints
- FTS5 query sanitization for search
- CORS origin restriction via `CORS_ORIGIN` env var
- Request body whitelisting on provider/browser routes
- URL validation replacing string `includes()` checks
- `--dry-run` flag for purge script
- AbortController cleanup on PersonDetail navigation
- PWA support: favicon, manifest, apple-touch-icon, theme-color

## Changed
- CI no longer auto-increments version on push to dev
- Release workflow no longer bumps version after release (changelog archiving preserved)
- CI permissions downgraded from `contents: write` to `contents: read`
- `process.exit(1)` in fetcher replaced with typed error
- ID mapping cache changed from FIFO to LRU eviction
- AI discovery runs bounded with MAX_STORED_RUNS limit
- Path finding guarded against infinite loops
- Error handler now logs stack traces
- `requestTimeout` middleware wired up
- `Person.parents` type corrected to `(string | null)[]`
- Scripts standardized on `import.meta.dirname` and shared types

## Fixed
- `person_computed` view multi-row bug in vital event joins
- `typeof gen !== '?'` bug in logPerson
- Stale closures in IntegrityPage loader functions
- D3 zoom cleanup missing in SparseTreePage
- `useSocket` spread in deps array causing re-renders
- `useSocketConnection` returning stale snapshot instead of reactive state
- Dead state (`setScrapedData`, `setImportFile`) removed
- Safe JSON.parse on localStorage in PersonDetail
- Purge script whole-token matching (prevents partial ID matches)
- Migration script wrapped in transaction

## Removed
- 20+ duplicate `DATA_DIR` declarations across services
- 3 duplicate `downloadImage` implementations
- 7 duplicate SSE header setup blocks
- 15 duplicate ULID validation blocks in person routes
- 3 duplicate browser connection blocks
- 3 duplicate operation tracker implementations
- 6 duplicate photo-serve route handlers
- Duplicate `BrowserStatus` interface in IndexerPage
